<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8" />
    <title>Lisans Paneli</title>
    <link rel="stylesheet" href="/static/styles.css" />
</head>
<body>
    <div class="panel-container">
        <h2>Lisans Paneli</h2>

        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, message in messages %}
              <div class="flash-message {{ category }}">{{ message }}</div>
            {% endfor %}
          {% endif %}
        {% endwith %}

        <form action="/add_license" method="POST" class="add-form">
            <input type="email" name="email" placeholder="Email" required />
            <input type="text" name="key" placeholder="Lisans Anahtarı" required />
            <input type="number" name="days" placeholder="Kaç Günlük" required min="1" max="3650" />
            <button type="submit">Lisans Ekle</button>
        </form>

        <table>
            <thead>
                <tr>
                    <th>Email</th>
                    <th>Lisans Anahtarı</th>
                    <th>Bitiş Tarihi</th>
                    <th>Kalan Gün</th>
                    <th>Sil</th>
                </tr>
            </thead>
            <tbody>
                {% for lic in licenses %}
                <tr class="{% if lic.days_left <= 0 %}expired{% elif lic.days_left <= 3 %}warning{% endif %}">
                    <td>{{ lic.email }}</td>
                    <td>{{ lic.key }}</td>
                    <td>{{ lic.expire_date }}</td>
                    <td>{{ lic.days_left }}</td>
                    <td><a href="/delete_license/{{ lic.id }}">🗑️</a></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <a href="/logout" class="logout">Çıkış Yap</a>
    </div>
</body>
</html>